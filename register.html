<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register Attendee</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
<h2>Register New Attendee</h2>
<input type="text" id="name" placeholder="Enter Name"/>
<input type="file" id="fileInput"/>
<button id="registerBtn">Register</button>
<button onclick="window.location.href='index.html'">Go to Scanner</button>

<script>
const SUPABASE_URL = "https://rkmgufohlmqknqkmmduu.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJrbWd1Zm9obG1xa25xa21tZHV1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4NDc2MzQsImV4cCI6MjA3MTQyMzYzNH0.aZxyaYCqD_6YcXoZDGqDkwft60lH0LaoegGc9EVwf7U";
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

document.getElementById('registerBtn').addEventListener('click', async () => {
    const name = document.getElementById('name').value;
    const file = document.getElementById('fileInput').files[0];
    if(!name || !file) return alert("Enter name and choose a file");

    const { data, error } = await supabase.storage.from('attendees')
        .upload(`reference_faces/${Date.now()}_${file.name}`, file);

    if(error) return alert(error.message);

    const imageUrl = `${SUPABASE_URL}/storage/v1/object/public/attendees/${data.path}`;
    await supabase.from('attendees').insert([{ name, reference_image_url: imageUrl }]);
    alert("Registered successfully!");
});
</script>
</body>
</html>
